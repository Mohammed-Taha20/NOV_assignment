{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "", "confidence": 0.6, "explanation": "Classification: rag. RAG-based answer.", "citations": ["product_policy::chunk0", "catalog::chunk0", "marketing_calendar::chunk0"]}
{"id": "hybrid_top_category_qty_summer_1997", "final_answer": {"category": "", "quantity": 0}, "sql": "SELECT \n            c.CategoryName as category,\n            SUM(od.Quantity) as quantity\n        FROM \"Order Details\" od\n        JOIN Products p ON od.ProductID = p.ProductID\n        JOIN Categories c ON p.CategoryID = c.CategoryID\n        JOIN Orders o ON od.OrderID = o.OrderID\n        WHERE 1=1  AND o.OrderDate >= '1997-06-01' AND o.OrderDate <= '1997-06-30'\n        GROUP BY c.CategoryName\n        ORDER BY quantity DESC", "confidence": 0.6, "explanation": "Classification: hybrid. RAG-based answer.", "citations": ["Categories", "Order", "Orders", "Products", "marketing_calendar::chunk0", "catalog::chunk0", "kpi_definitions::chunk0"]}
{"id": "hybrid_aov_winter_1997", "final_answer": 0.0, "sql": "\n        SELECT \n            SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) as aov\n        FROM \"Order Details\" od\n        JOIN Orders o ON od.OrderID = o.OrderID\n        WHERE o.OrderDate >= '1997-12-01' AND o.OrderDate <= '1997-12-31'\n        ", "confidence": 1.0, "explanation": "Classification: hybrid. SQL executed successfully.", "citations": ["Order", "Orders", "kpi_definitions::chunk0", "marketing_calendar::chunk0", "catalog::chunk0"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "C\u00f4te de Blaye", "revenue": 53265895.23}, {"product": "Th\u00fcringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT \n            p.ProductName as product,\n            SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) as revenue\n        FROM \"Order Details\" od\n        JOIN Products p ON od.ProductID = p.ProductID\n        JOIN Orders o ON od.OrderID = o.OrderID\n        WHERE 1=1 \n        GROUP BY p.ProductName\n        ORDER BY revenue DESC\n        LIMIT 3", "confidence": 0.9, "explanation": "Classification: sql. SQL executed successfully.", "citations": ["Order", "Orders", "Products"]}
{"id": "hybrid_revenue_beverages_summer_1997", "final_answer": 0.0, "sql": "SELECT \n            SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) as revenue\n        FROM \"Order Details\" od\n        JOIN Products p ON od.ProductID = p.ProductID\n        JOIN Categories c ON p.CategoryID = c.CategoryID\n        JOIN Orders o ON od.OrderID = o.OrderID\n        WHERE c.CategoryName = 'Beverages' AND o.OrderDate >= '1997-06-01' AND o.OrderDate <= '1997-06-30'", "confidence": 1.0, "explanation": "Classification: hybrid. SQL executed successfully.", "citations": ["Categories", "Order", "Orders", "Products", "marketing_calendar::chunk0", "catalog::chunk0", "kpi_definitions::chunk0"]}
{"id": "hybrid_best_customer_margin_1997", "final_answer": {"customer": "", "margin": 0.0}, "sql": "SELECT \n            cu.CompanyName as customer,\n            SUM((od.UnitPrice - (od.UnitPrice * 0.7)) * od.Quantity * (1 - od.Discount)) as margin\n        FROM \"Order Details\" od\n        JOIN Orders o ON od.OrderID = o.OrderID\n        JOIN Customers cu ON o.CustomerID = cu.CustomerID\n        WHERE 1=1 AND o.OrderDate >= '1997-01-01' AND o.OrderDate <= '1997-12-31'\n        GROUP BY cu.CompanyName\n        ORDER BY margin DESC\n        LIMIT 1", "confidence": 0.6, "explanation": "Classification: hybrid. RAG-based answer.", "citations": ["Customers", "Order", "Orders", "kpi_definitions::chunk0", "catalog::chunk0", "marketing_calendar::chunk0"]}
